#!/bin/execlineb -P

backtick -D "/app /defaults" DEFAULT_EXEC_DIR {
	printcontenv DEFAULT_EXEC_DIR
}
importas -isu DEFAULT_EXEC_DIR DEFAULT_EXEC_DIR
forx -o 0 -p -E dir { ${DEFAULT_EXEC_DIR} }
elglob -s0 g "${dir}/*"
forx -o 0 -p -E path { ${g} }
if -t { s6-test -f ${path} }
if -t {
	ifelse {
		pipeline { grep -n "#!" ${path} }
		grep -q "1:#!"
	} { chmod a+x ${path} }
	s6-test -x ${path}
}
s6-ln -fs ${path} "/usr/local/bin"
